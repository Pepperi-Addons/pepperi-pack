(self.webpackChunkfile_4817f4fe_9ff6_435e_9415_96b1142675eb=self.webpackChunkfile_4817f4fe_9ff6_435e_9415_96b1142675eb||[]).push([["default-node_modules_pepperi-addons_ngx-composite-lib_fesm2020_pepperi-addons-ngx-composite-l-9429ec","node_modules_babel_runtime_helpers_esm_asyncToGenerator_js-_5cc23","node_modules_babel_runtime_helpers_esm_asyncToGenerator_js-_5cc24","node_modules_babel_runtime_helpers_esm_asyncToGenerator_js-_5cc25","node_modules_babel_runtime_helpers_esm_asyncToGenerator_js-_5cc26","node_modules_babel_runtime_helpers_esm_asyncToGenerator_js-_5cc20","node_modules_babel_runtime_helpers_esm_asyncToGenerator_js-_5cc21","node_modules_babel_runtime_helpers_esm_asyncToGenerator_js-_5cc27","node_modules_babel_runtime_helpers_esm_asyncToGenerator_js-_5cc22"],{65760:(b,C,l)=>{l.r(C),l.d(C,{ManageParametersComponent:()=>v,PepManageParametersModule:()=>R});var g=l(15861),t=l(60562),y=l(62923),M=l(88955),m=l(9825),f=l(61111),A=l(43014),d=l(14768),u=l(14291),E=l(67409),h=l(58457);let P=(()=>{class s{constructor(e){this.translate=e}getAvailableTypes(){return A.SchemeFieldTypes.filter(a=>!1===["Array","DateTime","Resource","ContainedResource","DynamicResource","ContainedDynamicResource","MultipleStringValues"].includes(a)).map(a=>({Key:a,Value:a}))}convertParamsTypeToDVType(e){let a="TextBox";switch(e){case"Bool":a="Boolean";break;case"Integer":a="NumberInteger";break;case"Double":a="NumberReal"}return a}getDataViewField(e,a,i,n,c,r,o,p){const _={FieldID:e,Type:a,Title:i,Mandatory:n,ReadOnly:c};return r&&(_.OptionalValues=r),o&&(_.AdditionalProps=o),p&&(_.Layout=p),_}getParametersListDataView(e,a,i){let n,c;return e.length>0?(n=e.map(r=>this.getDataViewField(r.Key,r.Type,r.Title,!1,!0,[],{})),c=e.map(r=>({Width:r.Width}))):(n=[this.getDataViewField("Key","Link",this.translate.instant("MANAGE_PARAMETERS.KEY_TITLE"),!1,!0),this.getDataViewField("Description","TextBox",this.translate.instant("MANAGE_PARAMETERS.DESCRIPTION_TITLE"),!1,!0)],a&&n.push(this.getDataViewField("Type","TextBox",this.translate.instant("MANAGE_PARAMETERS.TYPE_TITLE"),!1,!0)),n.push(this.getDataViewField("DefaultValue","TextBox",this.translate.instant("MANAGE_PARAMETERS.DEFAULT_VALUE_TITLE"),!1,!0)),i&&n.push(this.getDataViewField("Internal","Boolean",this.translate.instant("MANAGE_PARAMETERS.INTERNAL_TITLE"),!1,!0)),c=n.map(r=>({Width:100/n.length}))),{Context:{Name:"",Profile:{InternalID:0},ScreenSize:"Landscape"},Type:"Grid",Title:"",Fields:n,Columns:c,FrozenColumnsCount:0,MinimumColumnWidth:0}}getParameterFormDataView(e,a,i,n){const c=this.getAvailableTypes(),r={emptyOption:!1},o=[this.getDataViewField("Key","TextBox",this.translate.instant("MANAGE_PARAMETERS.KEY_TITLE"),"add"===e,"add"!=e,[],{regex:"^([a-zA-Z0-9-_])*$",regexError:this.translate.instant("MANAGE_PARAMETERS.KEY_REGEX_ERROR")}),this.getDataViewField("Description","TextArea",this.translate.instant("MANAGE_PARAMETERS.DESCRIPTION_TITLE"),!1,!1,[],{},{Size:{Width:1,Height:2}})];if(i&&this.getDataViewField("Type","ComboBox",this.translate.instant("MANAGE_PARAMETERS.TYPE_TITLE"),!1,"add"!=e,c,r),o.push(this.getDataViewField("DefaultValue",this.convertParamsTypeToDVType(a),this.translate.instant("MANAGE_PARAMETERS.DEFAULT_VALUE_TITLE"),!1,!1,[],{})),n){const p={renderTitle:!1,renderEnlargeButton:!1},_={Size:{Height:0,Width:1}};o.push(this.getDataViewField("Accessibility_Description","RichTextHTML",this.translate.instant("MANAGE_PARAMETERS.INTERNAL_DESCRIPTION"),!1,!0,[],p,_));const D=[{Key:"Internal",Value:"Internal"},{Key:"External",Value:"External"}];o.push(this.getDataViewField("Accessibility","ComboBox",this.translate.instant("MANAGE_PARAMETERS.ACCESSIBILITY_TITLE"),!1,!1,D,r))}return{Type:"Form",Fields:o,Context:{Name:"",Profile:{},ScreenSize:"Tablet"}}}}return s.\u0275fac=function(e){return new(e||s)(t.\u0275\u0275inject(d.TranslateService))},s.\u0275prov=t.\u0275\u0275defineInjectable({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),S=(()=>{class s{constructor(e,a,i,n){this.dialogRef=e,this.manageParametersService=a,this.translate=i,this.incoming=n,this.parameter=void 0,this.showType=!1,this.showAccessibility=!1,this.isValid=!0}loadDataView(e){this.dataView=this.manageParametersService.getParameterFormDataView(this.incoming.Mode,e||"String",this.showType,this.showAccessibility)}ngOnInit(){this.parameter=this.getParameter(this.incoming.Parameter),this.showType=this.incoming.ShowType??!1,this.showAccessibility=this.incoming.ShowAccessibility??!1,this.loadDataView(this.parameter?.Type)}saveParameter(){this.parameter&&this.showAccessibility&&(delete this.parameter.Accessibility,delete this.parameter.Accessibility_Description),this.close(this.parameter)}close(e){this.dialogRef.close(e||null)}getParameter(e){const a=JSON.parse(JSON.stringify(e));return Object.keys(e||{}).forEach(i=>{"boolean"!=typeof e[i]?e[i]&&(a[i]=e[i].toString()):"Internal"===i&&this.showAccessibility?a.Accessibility=e[i]?"Internal":"External":a[i]=e[i]}),this.showAccessibility&&(a.Accessibility_Description=this.translate.instant("MANAGE_PARAMETERS.INTERNAL_DESCRIPTION")),a}onValueChanged(e){"Type"===e.ApiName&&this.showType?this.loadDataView(e.Value):"Accessibility"===e.ApiName&&this.showAccessibility&&this.parameter&&(this.parameter.Internal="Internal"===e.Value)}}return s.\u0275fac=function(e){return new(e||s)(t.\u0275\u0275directiveInject(f.MatDialogRef),t.\u0275\u0275directiveInject(P),t.\u0275\u0275directiveInject(d.TranslateService),t.\u0275\u0275directiveInject(f.MAT_DIALOG_DATA))},s.\u0275cmp=t.\u0275\u0275defineComponent({type:s,selectors:[["manage-parameter"]],decls:11,vars:16,consts:[[3,"title"],["pep-dialog-content",""],[3,"dataSource","dataView","formValidationChange","valueChange"],["addForm",""],["pep-dialog-actions",""],[1,"pep-spacing-element-negative",2,"display","flex"],[1,"pep-spacing-element",3,"sizeType","value","styleType","buttonClick"],[1,"pep-spacing-element",3,"sizeType","value","styleType","disabled","buttonClick"]],template:function(e,a){1&e&&(t.\u0275\u0275elementStart(0,"pep-dialog",0),t.\u0275\u0275pipe(1,"translate"),t.\u0275\u0275elementContainerStart(2,1),t.\u0275\u0275elementStart(3,"pep-generic-form",2,3),t.\u0275\u0275listener("formValidationChange",function(n){return a.isValid=n})("valueChange",function(n){return a.onValueChanged(n)}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd(),t.\u0275\u0275elementContainerStart(5,4),t.\u0275\u0275elementStart(6,"div",5)(7,"pep-button",6),t.\u0275\u0275listener("buttonClick",function(){return a.close()}),t.\u0275\u0275pipe(8,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(9,"pep-button",7),t.\u0275\u0275listener("buttonClick",function(){return a.saveParameter()}),t.\u0275\u0275pipe(10,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementContainerEnd(),t.\u0275\u0275elementEnd()),2&e&&(t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(1,10,"edit"===a.incoming.Mode?"MANAGE_PARAMETERS.EDIT_FORM_TITLE":"MANAGE_PARAMETERS.ADD_FORM_TITLE")),t.\u0275\u0275advance(3),t.\u0275\u0275property("dataSource",a.parameter)("dataView",a.dataView),t.\u0275\u0275advance(4),t.\u0275\u0275property("sizeType","md")("value",t.\u0275\u0275pipeBind1(8,12,"Cancel"))("styleType","weak"),t.\u0275\u0275advance(2),t.\u0275\u0275property("sizeType","md")("value",t.\u0275\u0275pipeBind1(10,14,"edit"===a.incoming.Mode?"Update":"Save"))("styleType","strong")("disabled",!a.isValid))},dependencies:[m.PepDialogComponent,u.PepButtonComponent,E.GenericFormComponent,d.TranslatePipe]}),s})(),v=(()=>{class s{constructor(e,a,i){var c,n=this;this.translate=e,this.dataViewService=a,this.dialogService=i,this.showType=!1,this.showAccessibility=!1,this.parametersColumns=[],this.parameters=[],this.parametersTitle="",this.parametersChange=new t.EventEmitter,this.listMessages={},this.actions={get:(c=(0,g.Z)(function*(r){const o=[];return r&&1==r.rows.length&&(o.push({title:n.translate.instant("Edit"),handler:(p=(0,g.Z)(function*(_){n.openCreateParamForm("edit",_.rows[0])}),function(D){return p.apply(this,arguments)})}),o.push({title:n.translate.instant("Delete"),handler:function(){var p=(0,g.Z)(function*(_){n.showDeleteDialog(_.rows[0])});return function(D){return p.apply(this,arguments)}}()})),o;var p}),function(o){return c.apply(this,arguments)})}}notifyParametersChange(){this.parametersChange.emit(this.parameters),this.dataSource=this.getDataSource()}getDataSource(){var a,e=this;return{init:(a=(0,g.Z)(function*(i){const n=e.dataViewService.getParametersListDataView(e.parametersColumns,e.showType,e.showAccessibility);return console.log("data view:",n),{dataView:n,totalCount:e.parameters.length,items:e.parameters}}),function(n){return a.apply(this,arguments)}),inputs:{pager:{type:"scroll"},selectionType:"single",emptyState:{show:!0,title:this.listMessages["MANAGE_PARAMETERS.EMPTY_STATE_TITLE"],description:this.listMessages["MANAGE_PARAMETERS.EMPTY_STATE_DESCRIPTION"]}}}}ngOnInit(){this.translate.get(["MANAGE_PARAMETERS.EMPTY_STATE_TITLE","MANAGE_PARAMETERS.EMPTY_STATE_DESCRIPTION"]).subscribe(e=>{this.listMessages=e,this.dataSource=this.getDataSource()})}onFieldClick(e){this.openCreateParamForm("edit",e.value)}openCreateParamForm(e,a=""){const i=this.parameters.find(p=>p.Key===a),n={DefaultValue:"",Key:"",Type:"String",Description:""};this.showAccessibility&&(n.Internal=!1);const r={Parameter:{...n,...i},Mode:e,ShowType:this.showType,ShowAccessibility:this.showAccessibility},o=this.dialogService.getDialogConfig({},"large");o.data=new m.PepDialogData({content:S}),this.dialogService.openDialog(S,r,o).afterClosed().subscribe(p=>{if(p){const _=this.parameters.findIndex(D=>D.Key===p.Key);_<0?this.parameters.push(p):this.parameters.splice(_,1,p),this.notifyParametersChange()}})}showDeleteDialog(e){var a=this;const i=new m.PepDialogData({title:this.translate.instant("MANAGE_PARAMETERS.DELETE_DIALOG_TITLE",{param_name:e}),actionsType:"cancel-delete",content:this.translate.instant("MANAGE_PARAMETERS.DELETE_DIALOG_CONTENT")});this.dialogService.openDefaultDialog(i).afterClosed().subscribe(function(){var n=(0,g.Z)(function*(c){if(c){const r=a.parameters.findIndex(o=>o.Key===e);r>-1&&(a.parameters.splice(r,1),a.notifyParametersChange())}});return function(c){return n.apply(this,arguments)}}())}}return s.\u0275fac=function(e){return new(e||s)(t.\u0275\u0275directiveInject(d.TranslateService),t.\u0275\u0275directiveInject(P),t.\u0275\u0275directiveInject(m.PepDialogService))},s.\u0275cmp=t.\u0275\u0275defineComponent({type:s,selectors:[["pep-manage-parameters"]],inputs:{showType:"showType",showAccessibility:"showAccessibility",parametersColumns:"parametersColumns",parameters:"parameters",parametersTitle:"parametersTitle"},outputs:{parametersChange:"parametersChange"},decls:5,vars:14,consts:[[1,"generic-list",3,"title","showTopBar","dataSource","inline","actions","addPadding","uuidMapping","fieldClick"],["right-buttons",""],[1,"pep-spacing-element",3,"sizeType","value","styleType","buttonClick"]],template:function(e,a){1&e&&(t.\u0275\u0275elementStart(0,"pep-generic-list",0),t.\u0275\u0275listener("fieldClick",function(n){return a.onFieldClick(n)}),t.\u0275\u0275pipe(1,"translate"),t.\u0275\u0275elementContainerStart(2,1),t.\u0275\u0275elementStart(3,"pep-button",2),t.\u0275\u0275listener("buttonClick",function(){return a.openCreateParamForm("add","")}),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd(),t.\u0275\u0275elementEnd()),2&e&&(t.\u0275\u0275property("title",a.parametersTitle||t.\u0275\u0275pipeBind1(1,10,"MANAGE_PARAMETERS.TITLE"))("showTopBar",!0)("dataSource",a.dataSource)("inline",!0)("actions",a.actions)("addPadding",!1)("uuidMapping","Key"),t.\u0275\u0275advance(3),t.\u0275\u0275property("sizeType","sm")("value",t.\u0275\u0275pipeBind1(4,12,"MANAGE_PARAMETERS.ADD_BUTTON_TITLE"))("styleType","strong"))},dependencies:[u.PepButtonComponent,h.GenericListComponent,d.TranslatePipe],styles:["[_nghost-%COMP%]   .generic-list[_ngcontent-%COMP%]{height:100%}"]}),s})(),R=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.\u0275\u0275defineNgModule({type:s}),s.\u0275inj=t.\u0275\u0275defineInjector({providers:[P],imports:[y.CommonModule,M.PepNgxLibModule,m.PepDialogModule,u.PepButtonModule,h.PepGenericListModule,E.PepGenericFormModule]}),s})()},15861:(b,C,l)=>{function g(y,M,m,f,A,d,u){try{var E=y[d](u),h=E.value}catch(P){return void m(P)}E.done?M(h):Promise.resolve(h).then(f,A)}function t(y){return function(){var M=this,m=arguments;return new Promise(function(f,A){var d=y.apply(M,m);function u(h){g(d,f,A,u,E,"next",h)}function E(h){g(d,f,A,u,E,"throw",h)}u(void 0)})}}l.d(C,{Z:()=>t})}}]);