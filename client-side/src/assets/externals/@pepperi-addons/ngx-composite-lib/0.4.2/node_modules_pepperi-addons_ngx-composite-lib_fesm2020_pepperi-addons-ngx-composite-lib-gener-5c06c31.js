(self.webpackChunkblock=self.webpackChunkblock||[]).push([["node_modules_pepperi-addons_ngx-composite-lib_fesm2020_pepperi-addons-ngx-composite-lib-gener-5c06c31"],{94120:(j,u,l)=>{l.r(u),l.d(u,{GenericFormComponent:()=>U,PepGenericFormModule:()=>w,PepGenericFormService:()=>m});var h=l(15861),n=l(60562),s=l(62923),c=l(11688),F=l(63675),v=l(34877),g=l(57139),f=l(38),y=l(49878);const P=["pepFormContainer"];function D(o,i){1&o&&n.\u0275\u0275elementContainer(0)}function M(o,i){if(1&o&&(n.\u0275\u0275elementStart(0,"div",7),n.\u0275\u0275template(1,D,1,0,"ng-container",6),n.\u0275\u0275elementEnd()),2&o){n.\u0275\u0275nextContext(2);const e=n.\u0275\u0275reference(3);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngTemplateOutlet",e)}}function T(o,i){1&o&&n.\u0275\u0275elementContainer(0)}const E=function(o){return{"add-padding":o}};function O(o,i){if(1&o&&(n.\u0275\u0275elementStart(0,"div",4),n.\u0275\u0275template(1,M,2,1,"div",5),n.\u0275\u0275template(2,T,1,0,"ng-container",6),n.\u0275\u0275elementEnd()),2&o){const e=n.\u0275\u0275nextContext(),t=n.\u0275\u0275reference(5);n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction1(3,E,e.addPadding)),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",e.showTopBar),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngTemplateOutlet",t)}}function x(o,i){1&o&&n.\u0275\u0275elementContainer(0)}function I(o,i){if(1&o&&(n.\u0275\u0275elementContainerStart(0,11),n.\u0275\u0275template(1,x,1,0,"ng-container",6),n.\u0275\u0275elementContainerEnd()),2&o){n.\u0275\u0275nextContext(2);const e=n.\u0275\u0275reference(3);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngTemplateOutlet",e)}}function V(o,i){1&o&&n.\u0275\u0275elementContainer(0)}function b(o,i){if(1&o&&(n.\u0275\u0275elementStart(0,"pep-page-layout",8),n.\u0275\u0275template(1,I,2,1,"ng-container",9),n.\u0275\u0275elementStart(2,"div",10),n.\u0275\u0275template(3,V,1,0,"ng-container",6),n.\u0275\u0275elementEnd()()),2&o){const e=n.\u0275\u0275nextContext(),t=n.\u0275\u0275reference(5);n.\u0275\u0275property("addPadding",e.addPadding),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",e.showTopBar),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngTemplateOutlet",t)}}function A(o,i){if(1&o&&(n.\u0275\u0275elementStart(0,"pep-top-bar",12)(1,"div",13),n.\u0275\u0275projection(2),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(3,"div",14),n.\u0275\u0275projection(4,1),n.\u0275\u0275elementEnd()()),2&o){const e=n.\u0275\u0275nextContext();n.\u0275\u0275property("inline",e.inline)}}const G=function(o,i){return{"form-view":o,"padding-bottom":i}};function L(o,i){if(1&o&&(n.\u0275\u0275elementStart(0,"div",15),n.\u0275\u0275elementContainer(1,null,16),n.\u0275\u0275elementEnd()),2&o){const e=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction2(1,G,e.showTopBar,!e.showTopBar))}}const S=[[["","left-buttons",""]],[["","right-buttons",""]]],R=["[left-buttons]","[right-buttons]"];let m=(()=>{class o{constructor(){}hasProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}createFormField(e){const t={};return t.ApiName=e.ApiName,t.Value=e.controlFieldValue,t.FormattedValue=e.controlFieldValue,t.FieldType=e.FieldType,t.Enabled=!e.ReadOnly,t.Visible=!e.Hidden,t.GroupFields=[],t.Highlighted=!1,t.OptionalValues=e.OptionalValues,t.AdditionalProps=e.AdditionalProps,t}convertToUiControlField(e){return{ApiName:e.ApiName,FieldType:e.FieldType,Title:e.Title,ReadOnly:e.ReadOnlyField,Mandatory:e.MandatoryField,Hidden:e.Hidden,ColumnWidth:e.ColumnWidth,ColumnWidthType:1,MaxFieldCharacters:e.MaxCharacters,MinValue:e.MinValue,MaxValue:e.MaxValue,Layout:{X:e.Layout.X,Y:e.Layout.Y,Width:e.Layout.Width,Height:e.Layout.Field_Height,XAlignment:e.Layout.xAlignment,YAlignment:e.Layout.yAlignment}}}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=n.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o})(),U=(()=>{class o{constructor(e,t){this.layoutService=e,this._genericFormService=t,this.isLocked=!1,this.inline=!1,this.showTopBar=!1,this.addPadding=!1,this.valueChange=new n.EventEmitter,this.fieldClick=new n.EventEmitter,this.formValidationChange=new n.EventEmitter,this.layoutService.onResize$.pipe().subscribe(p=>{}),this._formData=new c.ObjectsDataRow,this._uiControl=new c.UIControl}set pepListContainer(e){this._pepFormContainer=e}set dataSource(e){this._data=e}set dataView(e){this.initForm(e)}ngOnInit(){}initForm(e){var t=this;setTimeout((0,h.Z)(function*(){if(t._pepFormContainer){t._pepFormContainer.length&&(t._pepFormContainer.remove(),t._formData=new c.ObjectsDataRow,t._uiControl=new c.UIControl);const{PepFormComponent:p}=yield Promise.resolve().then(l.t.bind(l,63675,19)),a=t._pepFormContainer.createComponent(p);t._pepForm=a.instance,t._formData.IsEditable=!t.isLocked,t._formData.UID=e.UID||c.PepGuid.newGuid();const d=y.DataViewConverter.toUIControlData(e);d&&(d?.ControlFields&&(t._uiControl.ControlFields=d.ControlFields.map(r=>t._genericFormService.convertToUiControlField(r))),t._uiControl.Columns=d.Columns,t._uiControl.ControlFields?.length&&(t._formData.Fields=[],t._uiControl.ControlFields.forEach(r=>{let _,C="";t._genericFormService.hasProperty(t._data,r.ApiName)&&(C=t._data[r.ApiName]),e.Fields&&(_=e.Fields.find(N=>N.FieldID===r.ApiName));const B={...r,controlFieldValue:C,OptionalValues:_?.OptionalValues?.length?_.OptionalValues:[],AdditionalProps:_?.AdditionalProps||null};t._formData.Fields.push(t._genericFormService.createFormField(B))}),a.instance.layoutType="form",a.instance.layout=t._uiControl,a.instance.data=t._formData,a.instance.isInternal=!1,a.instance.lockFields=t.isLocked,a.instance.valueChange.subscribe(r=>{t.onValueChanged(r)}),a.instance.fieldClick.subscribe(r=>{t.onfieldClicked(r)}),a.instance.formValidationChange.subscribe(r=>{t.onFormValidationChanged(r)})))}}),0)}updateFieldValue(e){this._data[e.ApiName]=e.Value}getData(){return{UID:this._formData.UID,Values:this._data}}updateFields(e){for(const[t,p]of Object.entries(this._data)){const a=this._formData.Fields.findIndex(d=>d.ApiName===t);a>=0&&(this._formData.Fields[a].Value=p)}e.forEach(t=>{const p=this._formData.Fields.findIndex(a=>a.ApiName===t.FieldId);if(p>=0)for(const[a,d]of Object.entries(t.Params))if(this._genericFormService.hasProperty(this._formData.Fields[p],a)){const r=this._formData.Fields[p];r[a]=d,"Value"===a&&(r.FormattedValue=d)}}),this._pepForm.ReloadForm(),this._pepForm.data=this._formData}onValueChanged(e){const t={UID:e.id,ApiName:e.key,Value:e.value};this.updateFieldValue(t),this.valueChange.emit(t)}onfieldClicked(e){const t={UID:e.id,ApiName:e.key,Value:e.value};this.updateFieldValue(t),this.fieldClick.emit(t)}onFormValidationChanged(e){this.formValidationChange.emit(e)}}return o.\u0275fac=function(e){return new(e||o)(n.\u0275\u0275directiveInject(c.PepLayoutService),n.\u0275\u0275directiveInject(m))},o.\u0275cmp=n.\u0275\u0275defineComponent({type:o,selectors:[["pep-generic-form"]],viewQuery:function(e,t){if(1&e&&n.\u0275\u0275viewQuery(P,5,n.ViewContainerRef),2&e){let p;n.\u0275\u0275queryRefresh(p=n.\u0275\u0275loadQuery())&&(t.pepListContainer=p.first)}},inputs:{dataSource:"dataSource",dataView:"dataView",isLocked:"isLocked",inline:"inline",showTopBar:"showTopBar",addPadding:"addPadding"},outputs:{valueChange:"valueChange",fieldClick:"fieldClick",formValidationChange:"formValidationChange"},features:[n.\u0275\u0275ProvidersFeature([m])],ngContentSelectors:R,decls:6,vars:2,consts:[["class","inline-container",3,"ngClass",4,"ngIf"],[3,"addPadding",4,"ngIf"],["topBarTemplate",""],["formTemplate",""],[1,"inline-container",3,"ngClass"],["class","inline-top-bar-container",4,"ngIf"],[4,"ngTemplateOutlet"],[1,"inline-top-bar-container"],[3,"addPadding"],["pep-top-area","",4,"ngIf"],["pep-main-area","",1,"main-area-container"],["pep-top-area",""],[3,"inline"],["header-start-content",""],["header-end-content",""],[3,"ngClass"],["pepFormContainer",""]],template:function(e,t){1&e&&(n.\u0275\u0275projectionDef(S),n.\u0275\u0275template(0,O,3,5,"div",0),n.\u0275\u0275template(1,b,4,3,"pep-page-layout",1),n.\u0275\u0275template(2,A,5,1,"ng-template",null,2,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275template(4,L,3,4,"ng-template",null,3,n.\u0275\u0275templateRefExtractor)),2&e&&(n.\u0275\u0275property("ngIf",t.inline),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",!t.inline))},dependencies:[s.NgClass,s.NgIf,s.NgTemplateOutlet,g.PepPageLayoutComponent,f.PepTopBarComponent],styles:["[_nghost-%COMP%]{height:inherit;display:block}.main-area-container[_ngcontent-%COMP%]{display:grid;height:inherit}.inline-container[_ngcontent-%COMP%]{height:inherit;display:grid;grid-template-rows:auto 1fr}.inline-container.add-padding[_ngcontent-%COMP%]{padding-inline:var(--pep-spacing-lg, 1rem)}.padding-bottom[_ngcontent-%COMP%]{padding-bottom:var(--pep-spacing-lg, 1rem)}"]}),o})(),w=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=n.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=n.\u0275\u0275defineInjector({providers:[m],imports:[s.CommonModule,c.PepNgxLibModule,F.PepFormModule,v.PepMenuModule,g.PepPageLayoutModule,f.PepTopBarModule]}),o})()}}]);