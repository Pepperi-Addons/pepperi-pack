(self.webpackChunkblock=self.webpackChunkblock||[]).push([["node_modules_pepperi-addons_ngx-composite-lib_fesm2020_pepperi-addons-ngx-composite-lib-gener-5c06c30","node_modules_pepperi-addons_ngx-composite-lib_fesm2020_pepperi-addons-ngx-composite-lib-gener-5c06c31"],{94120:(M,F,r)=>{r.r(F),r.d(F,{GenericFormComponent:()=>U,PepGenericFormModule:()=>B,PepGenericFormService:()=>y});var v=r(15861),e=r(60562),s=r(62923),p=r(11688),h=r(63675),C=r(34877),_=r(57139),u=r(38),g=r(49878);const f=["pepFormContainer"];function m(o,i){1&o&&e.\u0275\u0275elementContainer(0)}function D(o,i){if(1&o&&(e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275template(1,m,1,0,"ng-container",6),e.\u0275\u0275elementEnd()),2&o){e.\u0275\u0275nextContext(2);const n=e.\u0275\u0275reference(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",n)}}function x(o,i){1&o&&e.\u0275\u0275elementContainer(0)}const E=function(o){return{"add-padding":o}};function O(o,i){if(1&o&&(e.\u0275\u0275elementStart(0,"div",4),e.\u0275\u0275template(1,D,2,1,"div",5),e.\u0275\u0275template(2,x,1,0,"ng-container",6),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext(),t=e.\u0275\u0275reference(5);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(3,E,n.addPadding)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.showTopBar),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",t)}}function b(o,i){1&o&&e.\u0275\u0275elementContainer(0)}function I(o,i){if(1&o&&(e.\u0275\u0275elementContainerStart(0,11),e.\u0275\u0275template(1,b,1,0,"ng-container",6),e.\u0275\u0275elementContainerEnd()),2&o){e.\u0275\u0275nextContext(2);const n=e.\u0275\u0275reference(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",n)}}function V(o,i){1&o&&e.\u0275\u0275elementContainer(0)}function A(o,i){if(1&o&&(e.\u0275\u0275elementStart(0,"pep-page-layout",8),e.\u0275\u0275template(1,I,2,1,"ng-container",9),e.\u0275\u0275elementStart(2,"div",10),e.\u0275\u0275template(3,V,1,0,"ng-container",6),e.\u0275\u0275elementEnd()()),2&o){const n=e.\u0275\u0275nextContext(),t=e.\u0275\u0275reference(5);e.\u0275\u0275property("addPadding",n.addPadding),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.showTopBar),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngTemplateOutlet",t)}}function G(o,i){if(1&o&&(e.\u0275\u0275elementStart(0,"pep-top-bar",12)(1,"div",13),e.\u0275\u0275projection(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",14),e.\u0275\u0275projection(4,1),e.\u0275\u0275elementEnd()()),2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275property("inline",n.inline)}}const L=function(o,i){return{"form-view":o,"padding-bottom":i}};function w(o,i){if(1&o&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275elementContainer(1,null,16),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(1,L,n.showTopBar,!n.showTopBar))}}const S=[[["","left-buttons",""]],[["","right-buttons",""]]],R=["[left-buttons]","[right-buttons]"];let y=(()=>{class o{constructor(){}hasProperty(n,t){return Object.prototype.hasOwnProperty.call(n,t)}createFormField(n){const t={};return t.ApiName=n.ApiName,t.Value=n.controlFieldValue,t.FormattedValue=n.controlFieldValue,t.FieldType=n.FieldType,t.Enabled=!n.ReadOnly,t.Visible=!n.Hidden,t.GroupFields=[],t.Highlighted=!1,t.OptionalValues=n.OptionalValues,t.AdditionalProps=n.AdditionalProps,t}convertToUiControlField(n){return{ApiName:n.ApiName,FieldType:n.FieldType,Title:n.Title,ReadOnly:n.ReadOnlyField,Mandatory:n.MandatoryField,Hidden:n.Hidden,ColumnWidth:n.ColumnWidth,ColumnWidthType:1,MaxFieldCharacters:n.MaxCharacters,MinValue:n.MinValue,MaxValue:n.MaxValue,Layout:{X:n.Layout.X,Y:n.Layout.Y,Width:n.Layout.Width,Height:n.Layout.Field_Height,XAlignment:n.Layout.xAlignment,YAlignment:n.Layout.yAlignment}}}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o})(),U=(()=>{class o{constructor(n,t){this.layoutService=n,this._genericFormService=t,this.isLocked=!1,this.inline=!1,this.showTopBar=!1,this.addPadding=!1,this.valueChange=new e.EventEmitter,this.fieldClick=new e.EventEmitter,this.formValidationChange=new e.EventEmitter,this.layoutService.onResize$.pipe().subscribe(d=>{}),this._formData=new p.ObjectsDataRow,this._uiControl=new p.UIControl}set pepListContainer(n){this._pepFormContainer=n}set dataSource(n){this._data=n}set dataView(n){this.initForm(n)}ngOnInit(){}initForm(n){var t=this;setTimeout((0,v.Z)(function*(){if(t._pepFormContainer){t._pepFormContainer.length&&(t._pepFormContainer.remove(),t._formData=new p.ObjectsDataRow,t._uiControl=new p.UIControl);const{PepFormComponent:d}=yield Promise.resolve().then(r.t.bind(r,63675,19)),a=t._pepFormContainer.createComponent(d);t._pepForm=a.instance,t._formData.IsEditable=!t.isLocked,t._formData.UID=n.UID||p.PepGuid.newGuid();const c=g.DataViewConverter.toUIControlData(n);c&&(c?.ControlFields&&(t._uiControl.ControlFields=c.ControlFields.map(l=>t._genericFormService.convertToUiControlField(l))),t._uiControl.Columns=c.Columns,t._uiControl.ControlFields?.length&&(t._formData.Fields=[],t._uiControl.ControlFields.forEach(l=>{let P,T="";t._genericFormService.hasProperty(t._data,l.ApiName)&&(T=t._data[l.ApiName]),n.Fields&&(P=n.Fields.find(k=>k.FieldID===l.ApiName));const N={...l,controlFieldValue:T,OptionalValues:P?.OptionalValues?.length?P.OptionalValues:[],AdditionalProps:P?.AdditionalProps||null};t._formData.Fields.push(t._genericFormService.createFormField(N))}),a.instance.layoutType="form",a.instance.layout=t._uiControl,a.instance.data=t._formData,a.instance.isInternal=!1,a.instance.lockFields=t.isLocked,a.instance.valueChange.subscribe(l=>{t.onValueChanged(l)}),a.instance.fieldClick.subscribe(l=>{t.onfieldClicked(l)}),a.instance.formValidationChange.subscribe(l=>{t.onFormValidationChanged(l)})))}}),0)}updateFieldValue(n){this._data[n.ApiName]=n.Value}getData(){return{UID:this._formData.UID,Values:this._data}}updateFields(n){for(const[t,d]of Object.entries(this._data)){const a=this._formData.Fields.findIndex(c=>c.ApiName===t);a>=0&&(this._formData.Fields[a].Value=d)}n.forEach(t=>{const d=this._formData.Fields.findIndex(a=>a.ApiName===t.FieldId);if(d>=0)for(const[a,c]of Object.entries(t.Params))if(this._genericFormService.hasProperty(this._formData.Fields[d],a)){const l=this._formData.Fields[d];l[a]=c,"Value"===a&&(l.FormattedValue=c)}}),this._pepForm.ReloadForm(),this._pepForm.data=this._formData}onValueChanged(n){const t={UID:n.id,ApiName:n.key,Value:n.value};this.updateFieldValue(t),this.valueChange.emit(t)}onfieldClicked(n){const t={UID:n.id,ApiName:n.key,Value:n.value};this.updateFieldValue(t),this.fieldClick.emit(t)}onFormValidationChanged(n){this.formValidationChange.emit(n)}}return o.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(p.PepLayoutService),e.\u0275\u0275directiveInject(y))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["pep-generic-form"]],viewQuery:function(n,t){if(1&n&&e.\u0275\u0275viewQuery(f,5,e.ViewContainerRef),2&n){let d;e.\u0275\u0275queryRefresh(d=e.\u0275\u0275loadQuery())&&(t.pepListContainer=d.first)}},inputs:{dataSource:"dataSource",dataView:"dataView",isLocked:"isLocked",inline:"inline",showTopBar:"showTopBar",addPadding:"addPadding"},outputs:{valueChange:"valueChange",fieldClick:"fieldClick",formValidationChange:"formValidationChange"},features:[e.\u0275\u0275ProvidersFeature([y])],ngContentSelectors:R,decls:6,vars:2,consts:[["class","inline-container",3,"ngClass",4,"ngIf"],[3,"addPadding",4,"ngIf"],["topBarTemplate",""],["formTemplate",""],[1,"inline-container",3,"ngClass"],["class","inline-top-bar-container",4,"ngIf"],[4,"ngTemplateOutlet"],[1,"inline-top-bar-container"],[3,"addPadding"],["pep-top-area","",4,"ngIf"],["pep-main-area","",1,"main-area-container"],["pep-top-area",""],[3,"inline"],["header-start-content",""],["header-end-content",""],[3,"ngClass"],["pepFormContainer",""]],template:function(n,t){1&n&&(e.\u0275\u0275projectionDef(S),e.\u0275\u0275template(0,O,3,5,"div",0),e.\u0275\u0275template(1,A,4,3,"pep-page-layout",1),e.\u0275\u0275template(2,G,5,1,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(4,w,3,4,"ng-template",null,3,e.\u0275\u0275templateRefExtractor)),2&n&&(e.\u0275\u0275property("ngIf",t.inline),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.inline))},dependencies:[s.NgClass,s.NgIf,s.NgTemplateOutlet,_.PepPageLayoutComponent,u.PepTopBarComponent],styles:["[_nghost-%COMP%]{height:inherit;display:block}.main-area-container[_ngcontent-%COMP%]{display:grid;height:inherit}.inline-container[_ngcontent-%COMP%]{height:inherit;display:grid;grid-template-rows:auto 1fr}.inline-container.add-padding[_ngcontent-%COMP%]{padding-inline:var(--pep-spacing-lg, 1rem)}.padding-bottom[_ngcontent-%COMP%]{padding-bottom:var(--pep-spacing-lg, 1rem)}"]}),o})(),B=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=e.\u0275\u0275defineInjector({providers:[y],imports:[s.CommonModule,p.PepNgxLibModule,h.PepFormModule,C.PepMenuModule,_.PepPageLayoutModule,u.PepTopBarModule]}),o})()},15861:(M,F,r)=>{function v(s,p,h,C,_,u,g){try{var f=s[u](g),m=f.value}catch(D){return void h(D)}f.done?p(m):Promise.resolve(m).then(C,_)}function e(s){return function(){var p=this,h=arguments;return new Promise(function(C,_){var u=s.apply(p,h);function g(m){v(u,C,_,g,f,"next",m)}function f(m){v(u,C,_,g,f,"throw",m)}g(void 0)})}}r.d(F,{Z:()=>e})}}]);